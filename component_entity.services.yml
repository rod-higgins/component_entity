services:
  # Main sync service
  component_entity.sync:
    class: Drupal\component_entity\ComponentSyncService
    arguments:
      - '@entity_type.manager'
      - '@plugin.manager.sdc'
      - '@logger.factory'
      - '@messenger'
      - '@event_dispatcher'
      - '@config.factory'
    tags:
      - { name: service_collector, tag: component_sync_processor, call: addProcessor }

  # Component validator
  component_entity.validator:
    class: Drupal\component_entity\ComponentValidator
    arguments:
      - '@plugin.manager.sdc'
      - '@logger.factory'

  # React renderer service
  component_entity.react_renderer:
    class: Drupal\component_entity\ComponentReactRenderer
    arguments:
      - '@renderer'
      - '@plugin.manager.sdc'
      - '@asset.resolver'
      - '@asset.css.collection_renderer'
      - '@asset.js.collection_renderer'
      - '@request_stack'

  # Cache manager for components
  component_entity.cache_manager:
    class: Drupal\component_entity\ComponentCacheManager
    arguments:
      - '@cache.default'
      - '@cache_tags.invalidator'
      - '@entity_type.manager'

  # Component renderer manager
  plugin.manager.component_renderer:
    class: Drupal\component_entity\Plugin\ComponentRendererManager
    parent: default_plugin_manager

  # Event subscribers
  component_entity.sync_subscriber:
    class: Drupal\component_entity\EventSubscriber\ComponentSyncSubscriber
    arguments:
      - '@component_entity.sync'
      - '@logger.factory'
    tags:
      - { name: event_subscriber }

  # Route subscriber for dynamic routes
  component_entity.route_subscriber:
    class: Drupal\component_entity\Routing\ComponentRouteSubscriber
    arguments:
      - '@entity_type.manager'
    tags:
      - { name: event_subscriber }

  # Access check for preview
  component_entity.preview_access:
    class: Drupal\component_entity\Access\ComponentPreviewAccessCheck
    arguments:
      - '@current_user'
    tags:
      - { name: access_check, applies_to: _component_preview_access }

  # Component library discovery
  component_entity.library_discovery:
    class: Drupal\component_entity\ComponentLibraryDiscovery
    arguments:
      - '@extension.list.module'
      - '@file_system'

  # Drush commands
  component_entity.commands:
    class: Drupal\component_entity\Commands\ComponentEntityCommands
    arguments:
      - '@component_entity.sync'
      - '@entity_type.manager'
      - '@logger.factory'
    tags:
      - { name: drush.command }

  # Logger channel
  logger.channel.component_entity:
    parent: logger.channel_base
    arguments: ['component_entity']

  # Component field manager
  component_entity.field_manager:
    class: Drupal\component_entity\ComponentFieldManager
    arguments:
      - '@entity_field.manager'
      - '@entity_type.manager'
      - '@plugin.manager.field.field_type'

  # Component permissions
  component_entity.permissions:
    class: Drupal\component_entity\ComponentPermissions
    arguments:
      - '@entity_type.manager'